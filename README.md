# JSON Schema Generator

Автоматизированная система генерации и управления JSON-схемами для описания бизнес-логики и интеграций с использованием искусственного интеллекта.
[Readme на frontend](frontend/README.md)

## Описание проекта

JSON Schema Generator — это решение на базе ИИ, которое упрощает и автоматизирует процесс создания, редактирования и валидации JSON-схем для описания бизнес-процессов и интеграционных сценариев. Система работает через интерактивный чат, позволяя пользователю в естественной форме описывать требования и получать готовые JSON-схемы.

### Основные возможности:

- **Автоматическая генерация JSON-схем** на основе текстового описания
- **Интерактивное редактирование** через диалоговый интерфейс с LLM
- **Уточнение недостающих параметров** с запросом дополнительной информации
- **Контроль шагов интеграции** с уведомлениями о нереализованных типах интеграции
- **Хранение контекста сессии** для последовательной работы над схемой

## Запуск

### Предварительные требования

- Docker и Docker Compose
- API-токен для доступа к языковой модели

### Установка и запуск

1. Клонируйте репозиторий:

2. Укажите `SECRET_TOKEN` для api к системе МТС в compose.yaml:
```yaml
   environment:
     - SECRET_TOKEN=your_token_here
```

3. Запустите приложение с помощью Docker Compose:
   ```bash
   docker-compose up --build
   ```

4. Приложение будет доступно по адресу: `http://localhost:8000`

## API Endpoints

### Проверка работоспособности
```
GET /
```
Возвращает статус работы API.

### Отправка сообщения
```
POST /chat
```
Отправляет сообщение в чат и получает ответ от системы.

**Тело запроса:**
```json
{
  "session_id": "уникальный_идентификатор_сессии",
  "message": "текст_сообщения"
}
```

**Ответ:**
```json
{
  "session_id": "уникальный_идентификатор_сессии",
  "response": "ответ_системы",
  "json_schema": "сгенерированная_json_схема"
}
```

### Очистка сессии
```
POST /clear
```
Очищает историю сообщений для указанной сессии.

**Тело запроса:**
```json
{
  "session_id": "уникальный_идентификатор_сессии"
}
```

## Архитектура системы

Система построена на основе агентного подхода с использованием библиотеки AutoGen и включает следующие компоненты:

1. **ChatManager** - центральный компонент, управляющий сессиями и обработкой сообщений
2. **SessionContext** - хранит контекст сессии, включая историю сообщений и собранные параметры
3. **Агенты**:
   - **schema_generator** - создает JSON-схемы на основе требований
   - **clarifier** - уточняет недостающие параметры и анализирует запросы пользователя
4. **Retriever** - компонент для поиска и извлечения информации из базы данных `lanceDB`.
Поиск осуществляется используя гибридный подход: `bm25` и `bge-m3` вектор.

## Настройка и конфигурация

Основные параметры конфигурации:

- `SECRET_TOKEN` - токен для доступа к API языковой модели
- `API_URL` - URL эндпоинта API языковой модели
- `MODEL_NAME` - название используемой языковой модели

## Примеры использования

### Пример 1: Создание схемы для интеграции с платежной системой

**Запрос:**
```
Мне нужна схема для rest запроса. Вот вся необходимая информация:...
```

**Ответ:**
```
Json-schema: `{...}
```

### Пример 2: Уточнение недостающих параметров

**Запрос:**
```
Хочу схему для rest

```

**Ответ:**
```
Для схемы необходимо сообщить информацию по следующим полям:...

```
